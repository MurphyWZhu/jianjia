<!DOCTYPE html>
<html lang="us" xmlns:th="http://www.thymeleaf.org">

<head>
    <title>蒹葭</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/css/bootstrap.min.css">
    <script src="https://cdn.staticfile.org/jquery/3.2.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/popper.js/1.15.0/umd/popper.min.js"></script>
    <link href="//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <script src="https://cdn.staticfile.org/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script>
        $(document).ready(function () {

            $("#search1").click(function () {
                $.get("/subsearchbox", "", function (data, status) {
                    $("#maindiv").html(data);
                });
            });
            $("#userinfobutton").click(function () {
                $.get("/subuserinfo", "", function (data, status) {
                    $("#maindiv").html(data);
                    $.post("/getuserinfo", "", function (data, status) {
                        if (data == "") {
                            $(window).attr('location', '/login');
                        } else {
                            var rr = $.parseJSON(JSON.stringify(data));
                            $("#validationTooltip01").val(rr.username);
                            $("#validationTooltip02").val(rr.nikename);
                            $("#validationTooltip03").val(rr.age);
                            $("#validationTooltip04").val(rr.sex);
                            $("#validationTooltip05").val(rr.department);
                            $("#validationTooltip06").val(rr.key);
                            $("#validationTooltip07").val(rr.like);
                        }
                    });
                });
            });
            $("#loginbutton").click(function () {
                $.get("/sublogin", "", function (data, status) {
                    $("#maindiv").html(data);
                })
            });
            $("#maindiv").on("click", "#tologinbutton", function () {
                $.post("/tologin", "username=" + $("#username-input")[0].value + "&password=" + $("#password-input")[0].value, function (data, status) {
                    var rr = $.parseJSON(data);
                    if (status == "success") {
                        if (rr.code == 0) {
                            $("#div1").append('<div class="alert alert-success alert-dismissible fade show" style="position:relative;top:10px;right:10px"><button type="button" class="close" data-dismiss="alert">&times;</button>' + rr.info + '</div>');
                            $(window).attr('location', '/index');
                        }
                        else {
                            $("#div1").append('<div class="alert alert-success alert-dismissible fade show" style="position:relative;top:10px;right:10px"><button type="button" class="close" data-dismiss="alert">&times;</button>' + rr.info + '</div>');
                        }
                    }
                });


            });
            $("#maindiv").on("click", "#searchboxbutton", function () {
                $.get("/tosearch", "key=" + $("#key").val() + "&sexfilter=" + $("#sexfilter").val() + "&departmentfilter=" + $("#departmentfilter").val(), function (data, status) {
                    $("#searchboxmaindiv").html(data);
                    $(".userinfodiv").click(function () {
                        $.get("/getuserspace", "username=" + $(this).attr('id'), function () {
                            //
                        });
                    });
                    $('button').click(function () {
                        if ($(this).hasClass("aaa")) {
                            $.post("/rmlike", "likeuser=" + $(this)[0].value, function (data, status) {
                                //var rr = $.parseJSON(data);
                            });
                            $(this).text("喜欢");
                            $(this).addClass("bbb btn-danger").removeClass("aaa btn-primary");
                        }
                        else if ($(this).hasClass("bbb")) {
                            $.post("/tolike", "likeuser=" + $(this)[0].value, function (data, status) {
                                //var rr = $.parseJSON(data);
                            });
                            $(this).text("取消喜欢");
                            $(this).addClass("aaa btn-primary").removeClass("bbb btn-danger");
                        }

                    });
                });
            });
            $("#usershows").click(function () {
                $.post("/getallusershows", "", function (data, status) {
                    $("#maindiv").html(data);
                });
            });
            $("#indexpostshowbutton").click(function () {
                $.post("/postshowbox", "", function (data, status) {
                    $("#maindiv").html(data);
                });
            });
            $("#maindiv").on("click", ".postshowbutton", function () {
                $.post("/postshow", "showdata=" + $("#showdata").val() + "&ispublic=" + $("#ispublic").is(':checked'), function (data, status) {
                    //
                });
            });
        });
    </script>
    <style type="text/css">
        body {
            background-image: url(https://www.a.a/a.jpg);
            background-repeat: no-repeat;
            background-attachment: fixed
        }

        .carousel-inner img {
            width: 100%;
            height: 100%;
        }
    </style>
</head>

<body>
    <div class="jumbotron text-center" style="margin-bottom:0;background-color: white">
        <h1>蒹葭</h1>
    </div>
    <nav class="navbar navbar-expand-sm bg-light navbar-light" style="color: rgb(196, 68, 68)">
        <div style="margin:0 auto;">
            <ul class="navbar-nav fa-ul">
                <li class="nav-item" style="margin: 0 50px;">
                    <i class="fa-li fa fa-check-square"></i>
                    <a class="nav-link" th:href="@{/index}">主页</a>
                </li>
                <li class="nav-item" style="margin: 0 50px;">
                    <i class="fa-li fa fa-search" aria-hidden="true"></i>
                    <a class="nav-link" id="search1">搜索</a>
                </li>
                <li class="nav-item" style="margin: 0 50px;">
                    <i class="fa-li fa fa-star" aria-hidden="true"></i>
                    <a class="nav-link" id="usershows">校园动态</a>
                </li>
                <li class="nav-item" style="margin: 0 50px;">
                    <i class="fa-li fa fa-gamepad"></i>
                    <a class="nav-link" th:href="@{/index}">游戏</a>
                </li>
                <li class="nav-item" style="margin: 0 50px;">
                    <i class="fa-li fa fa-book"></i>
                    <a class="nav-link" th:href="@{/index}">学习</a>
                </li>
                <li class="nav-item" style="margin: 0 50px;" th:if="${session.loginUser==null}">
                    <i class="fa-li fa fa-toggle-right"></i>
                    <a class="nav-link" id="loginbutton">登录</a>
                </li>
                <li class="nav-item dropdown" th:if="${session.loginUser!=null}" style="margin: 0 50px;">
                    <i class="fa-li fa fa-user" aria-hidden="true"></i>
                    <a class="nav-link dropdown-toggle" href="#" id="navbardrop" data-toggle="dropdown">
                        我的
                    </a>
                    <div class="dropdown-menu">
                        <a class="dropdown-item" id="userinfobutton">个人信息</a>
                        <a class="dropdown-item" id="indexpostshowbutton">发条动态</a>
                        <a class="dropdown-item" th:href="@{/logout}">注销</a>
                        <a class="dropdown-item" href="#">喜欢的人</a>
                    </div>
                </li>
            </ul>
        </div>

    </nav>

    <div id="maindiv" class="container-fluid">
        <div id="demo" class="carousel slide" data-ride="carousel">

            <!-- 指示符 -->
            <ul class="carousel-indicators">
                <li data-target="#demo" data-slide-to="0" class="active"></li>
                <li data-target="#demo" data-slide-to="1"></li>
                <li data-target="#demo" data-slide-to="2"></li>
            </ul>

            <!-- 轮播图片 -->
            <div class="carousel-inner">
                <div class="carousel-item active">
                    <img src="https://static.runoob.com/images/mix/img_fjords_wide.jpg">
                </div>
                <div class="carousel-item">
                    <img src="https://static.runoob.com/images/mix/img_nature_wide.jpg">
                </div>
                <div class="carousel-item">
                    <img src="https://static.runoob.com/images/mix/img_mountains_wide.jpg">
                </div>
            </div>

            <!-- 左右切换按钮 -->
            <a class="carousel-control-prev" href="#demo" data-slide="prev">
                <span class="carousel-control-prev-icon"></span>
            </a>
            <a class="carousel-control-next" href="#demo" data-slide="next">
                <span class="carousel-control-next-icon"></span>
            </a>

        </div>
    </div>
</body>

</html>